"use strict";var unccdApp=angular.module("unccdApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","angular-loading-bar","uiGmapgoogle-maps","LocalStorageModule","pascalprecht.translate","ui.bootstrap"]);unccdApp.config(["uiGmapGoogleMapApiProvider",function(a){a.configure({v:"3.20",libraries:"weather,geometry,visualization"})}]),unccdApp.config(["localStorageServiceProvider",function(a){a.setPrefix("unccdApp").setStorageType("sessionStorage").setNotify(!0,!0)}]),unccdApp.config(["$translateProvider",function(a){a.translations("en",{source:"Source",langname:"Language",keywords:"Keywords",regions_nav:"Regions",annexes_nav:"Annexes",nonannexes_nav:"Non Annexes",landmanagement_nav:"Land Management",classifications:"Capacity Building Marketplace Classification",climatezones_nav:"Climate Zones",typology:"Typology",datatype:"Data Type",format:"Format",authors_nav:"Authors",yearpublished:"Year Published",country:"Country",disciplines:"Disciplines",specializations:"Specializations",postcop:"Postcop",thematicareas:"Thematic Areas",topics:"Topics",infoformats:"Information Formats",description:"Description",description_en:"Description (en)",description_it:"Description (it)","abstract":"Abstract",body:"Body",body_en:"Body (en)",body_es:"Body (en)",lastname:"Last Name",firstname:"First Name",institution:"Institution",workexperience:"Work Experience",knowledgebase:"Knowledge Base",kss:"Knowledge Sharing System",managingentity:"Managing Entity",city:"City",yearmodified:"Year Modified",rearchived:"Rearchived",division:"Division",modified:"Modified",id:"ID",expertemail:"Expert Email",website:"Website",languages:"Other Languages",persontitle:"Title",sex:"Sex",score:"Score",nationality:"Nationality",telnumber:"Phone Number",geolocation:"Geolocation",registrationreq:"Registration Required",translation:"Translation",managingentitytype:"Managing Entity Type",searchcapability:"Search Capability",regions:"Regions",annexes:"Annexes",url:"URL",size:"Size",title:"Title",title_en:"Title (en)",title_es:"Title (es)",title_de:"Title (de)",title_it:"Title (it)",title_fr:"Title (fr)",nonannexes:"Non Annexes",landmanagement:"Land Management",contactemail:"Contact Email",citationcode:"Citation Code",contactname:"Contact Name",publication:"Publication",publishers:"Publishers",contactphone:"Contact Phone",published:"Published online",contactorganisation:"Contact Organisation",partnername:"Partner Name",authors:"Authors",abstract_en:"Abstract",abstract_es:"Abstract",abstract_de:"Abstract",abstract_it:"Abstract",abstract_fr:"Abstract",region:"Region",recarchived:"Record Archived",thematicareas_nav:"Thematic Areas",topics_nav:"Topics",type:"Type",climatezones:"Climatezones",docsource:"Docsource",subjects:"Subjects",volume:"Volume",yearsubmitte:"Year submitte",disciplines_nav:"Disciplines",specialization_nav:"Specialization",specializations_nav:"Specializations",postcop_nav:"Postcop"}),a.useSanitizeValueStrategy("sanitize"),a.preferredLanguage("en")}]),unccdApp.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/partials/homeView.html",controller:"homeController",activeTab:"home"}).when("/results",{templateUrl:"views/partials/resultsView.html",controller:"searchResultsController",activeTab:"results"}).when("/about",{templateUrl:"views/partials/aboutView.html",controller:"aboutController",activeTab:"about"}).when("/guides",{templateUrl:"views/partials/guidesView.html",controller:"guidesController",activeTab:"guides"}).when("/partners",{templateUrl:"views/partials/partnersView.html",controller:"partnersController",activeTab:"partners"}).when("/advancedSearch",{templateUrl:"views/partials/advancedSearchView.html",controller:"advancedSearchController",activeTab:"advancedSearch"}).when("/disclaimer",{templateUrl:"views/partials/disclaimerView.html",controller:"disclaimerController",activeTab:"disclaimer"}).when("/contact",{templateUrl:"views/partials/contactView.html",controller:"contactController",activeTab:"contact"}).otherwise({redirectTo:"/"})}]),unccdApp.filter("trusted",["$sce",function(a){return function(b){var c=angular.element("<textarea />").html(b).text();return a.trustAsHtml(c)}}]),unccdApp.controller("homeController",["$scope","$http","$timeout","localStorageService","communicationService","fileUtilityService",function(a,b,c,d,e,f){a.highlights=[],a.imgHighlights=[],a.highlightsCounter=0,a.showCarousel=!1,a.getHighlightsFilenames=function(){b.get("highlights/filenames.txt",{},{}).success(function(b){console.log("Get fileNames file success"),a.createHighlights(f.getHighlightsFilenames(b))}).error(function(a){console.log("ERROR getting the highlights filenames: "+JSON.stringify(a))})},a.createHighlights=function(b){for(var c=0;c<b.length;c++)a.highlightsCounter=a.highlightsCounter+1,a.getHighlightFile(b[c])},a.getHighlightFile=function(d){b.get("highlights/"+d,{},{}).success(function(b){console.log("Get file success"),a.highlights.push(f.createHighlightObject(b)),a.highlightsCounter=a.highlightsCounter-1,c(function(){0===a.highlightsCounter&&a.setCarousel()},10)}).error(function(b){a.highlightsCounter=a.highlightsCounter-1,console.log("ERROR getting the highlight file: "+JSON.stringify(b))})},a.getHighlightsFilenames(),a.search=function(){console.log("Setting range facets in the home page"),b.get(""+e.url+"/"+e.collectionName+"/"+e.searchHandler+"?q=*",{},{}).success(function(b){b.response.docs&&b.facet_counts.facet_fields?(console.log("Range facets set in the home page"),d.set("rangeFacets",a.rangeFacets)):console.log("ERROR: Search error: Incorrect response format")}).error(function(a){console.log("Search error: "+JSON.stringify(a))})},a.setCarousel=function(){a.showCarousel=!0,$("#unccd-highlights-carousel").carouFredSel({scroll:{items:1,duration:1e3},auto:3e3,responsive:!0,width:"100%",prev:"#prev",next:"#next",mousewheel:!0,swipe:{onMouse:!0,onTouch:!0},items:{width:400,visible:{min:2,max:3}}})}}]),unccdApp.controller("searchResultsController",["$scope","$http","$location","$compile","$timeout","$route","$modal","$sce","localStorageService","communicationService","resultsService","$window",function(a,b,c,d,e,f,g,h,i,j,k,l){a.results={},a.mapModeResults=[],a.facets={},a.currentResultItem={},a.resultsMode="list",a.rangeFacetsNames=[],a.loading=!0,a.documentsInMap=0,a.itemsPerPage=10,a.maxSize=5,a.bigTotalItems=0,a.bigCurrentPage=1,a.openedInfoWindow,a.mapResultsCount=0,a.listResultsCount=0,a.sourceDescription="",a.queryString="",a.usedFilters=[],a.setupPaginationInfo=function(b,c){b&&(b.numFound&&(a.bigTotalItems=b.numFound,a.listResultsCount=a.bigTotalItems),c.params&&c.params.rows&&(a.itemsPerPage=c.params.rows),b.start&&(a.bigCurrentPage=Math.floor(b.start/a.itemsPerPage)+1))},a.setPage=function(b){a.bigCurrentPage=b},a.pageChanged=function(){var b=(a.bigCurrentPage-1)*a.itemsPerPage;c.search("start",b).search("rows",a.itemsPerPage)},a.executeMapSearch=function(b){"list"==b||"map"==b?(a.resultsMode=b,"map"==b?(a.bigTotalItems=a.mapModeResults,e(function(){a.searchMapValues(a.generateQueryString(c.search()))},10)):a.bigTotalItems=a.listResultsCount):console.log("The selected button: "+b+", is not a valid option")},a.changeResultsMode=function(b,d){"list"===b||"map"===b?(a.resultsMode=b,"map"===b?(d&&c.search("resultsMode","map"),a.bigTotalItems=a.mapModeResults,e(function(){a.searchMapValues(a.generateQueryString(c.search()))},10)):(a.bigTotalItems=a.listResultsCount,d&&c.search("resultsMode","list"))):console.log("The selected button: "+b+", is not a valid option")},a.prepareResultModal=function(b){console.log("opening by index..."),a.currentResultItem=a.results[b],a.items=a.currentResultItem,a.openModal()},a.prepareResultModalWithId=function(d,e){console.log("opening by id...",d),e&&(e.preventDefault(),e.stopPropagation()),a.currentResultItem={};var f=!1,g=c.search().source;if("Partner"!==g)for(var h=0;h<a.results.length;h++)if(a.results[h].id===d){a.results[h].source&&(g=a.results[h].source),"Partner"!==g&&(a.currentResultItem=a.results[h],a.items=a.currentResultItem,a.openModal(),f=!0);break}f||b.get(""+j.url+"/"+j.collectionName+"/"+j.getSearchHandlerName(g,!0)+"?q=id:"+d,{},{}).success(function(b){b.response&&b.response.docs&&b.response.docs.length>0&&(a.currentResultItem=b.response.docs[0],a.items=a.currentResultItem,a.openModal())}).error(function(a){console.log("ERROR - Error getting the document details information: "+JSON.stringify(a))})},a.setFacetsState=function(){},a.facetSelected=function(b,d,e,f){var g=a.facets[b],h=!1,i="",j=!1;(e||f)&&(j=!0);for(var l=0;l<g.length&&!h;l++)g[l].name===d&&(a.facets[b][l].enabled?(i=k.removeRefiner(d,c.search()[b]),""===i&&(i=null),c.search("start","0").search(b,i)):c.search()[b]?j?c.search("start","0").search(b,c.search()[b]+","+k.encodeDateRefiner(e,f)):c.search("start","0").search(b,c.search()[b]+","+k.encodeRefiner(d)):j?c.search("start","0").search(b,k.encodeDateRefiner(e,f)):c.search("start","0").search(b,k.encodeRefiner(d)),h=!0)},a.map={center:{latitude:20,longitude:0},zoom:2,bounds:{}},a.options={scrollwheel:!1},a.mapMarkers=[],a.isInLocalStorage=function(a){var b=!1;return i.get(a)&&i.get(a).length>0&&(b=!0),b},a.countDocuments=function(a){for(var b=0,c=0;c<a.length;c++)a[c].geolocation&&(b+=1);return b},a.search=function(d){a.loading=!0,a.getMapCount(d),b.jsonp(""+j.url+"/"+j.collectionName+"/"+j.getSearchHandlerName(c.search().source)+"?"+d+"&json.wrf=JSON_CALLBACK",{},{}).success(function(b){if(b.response.docs&&b.facet_counts.facet_fields)if(a.results=b.response.docs,a.setupPaginationInfo(b.response,b.responseHeader),a.rangeFacetsNames=Object.getOwnPropertyNames(b.facet_counts.facet_ranges),a.facets=k.buildFacets(b.facet_counts.facet_fields,b.facet_counts.facet_ranges,c.search()),a.documentsInMap=a.countDocuments(a.results),a.usedFilters=k.usedFilters,c.search().index){var d=parseInt(c.search().index);a.prepareResultModal(d)}else c.search().docid&&a.prepareResultModalWithId(c.search().docid);else console.log("ERROR: Search error: Incorrect response format");a.loading=!1}).error(function(b){console.log("Search error: "+JSON.stringify(b)),a.loading=!1})},a.map,a.initialize=function(b){var c={center:new google.maps.LatLng(20,0),zoom:2,mapTypeId:google.maps.MapTypeId.ROADMAP};a.map=new google.maps.Map(b,c)},a.showMarkers=function(e,f){for(var g=[],h=[],i=0;i<f.length;i++)if(f[i].geolocation){h=f[i].geolocation.split(","),f[i].listPosition=i;var k=new google.maps.LatLng(h[0],h[1]),l=new google.maps.Marker({position:k,map:a.map}),m=new google.maps.InfoWindow,n="<infowindow></infowindow>",o=d(n)(e);google.maps.event.addListener(l,"click",function(d,e,f){return function(){a.openedInfoWindow&&(a.openedInfoWindow.close(),e.place={}),b.jsonp(""+j.url+"/"+j.collectionName+"/"+j.getSearchHandlerName(c.search().source)+"?fq=id:"+f.id+"&json.wrf=JSON_CALLBACK",{},{}).success(function(b){b.response&&b.response.docs&&b.response.docs.length>0&&(e.currentId=f.id,e.place=b.response.docs[0],m.setContent(o[0]),m.open(a.map,d),a.openedInfoWindow=m)}).error(function(a){console.log("ERROR - Error getting the pin information: "+JSON.stringify(a))})}}(l,e,f[i]))}else g.push(f[i]);return g},a.polling_interval=1,a.addMarkersByIntervals=function(b,c,d,f){c>f?a.showMarkers(a,d.slice(b,f)):(a.showMarkers(a,d.slice(b,c)),e(function(){a.addMarkersByIntervals(b+100,c+100,d,f)},a.polling_interval))},a.searchMapValues=function(d){var e=document.getElementById("map_canvas");a.initialize(e),b.jsonp(""+j.url+"/"+j.collectionName+"/"+j.getMapHandlerName(c.search().source)+"?"+d+"&json.wrf=JSON_CALLBACK",{},{}).success(function(b){if(b.response&&b.response.docs){var d=b.response.docs;a.bigTotalItems=b.response.numFound,a.mapResultsCount=a.bigTotalItems,a.facets={},a.facets=k.buildFacets(b.facet_counts.facet_fields,b.facet_counts.facet_ranges,c.search()),a.usedFilters=k.usedFilters,a.addMarkersByIntervals(0,100,d,d.length),google.maps.event.trigger(a.map,"resize"),a.map.setCenter(new google.maps.LatLng(20,0))}else console.log("ERROR - Map search error: Incorrect response format")}).error(function(a){console.log("Map search error: "+JSON.stringify(a))})},a.getMapCount=function(d){b.jsonp(""+j.url+"/"+j.collectionName+"/"+j.getMapHandlerName(c.search().source)+"?"+d+"&json.wrf=JSON_CALLBACK",{},{}).success(function(b){b.response&&b.response.docs?a.mapResultsCount=b.response.numFound:(console.log("ERROR - Map search error: Incorrect response format"),a.mapResultsCount=0)}).error(function(b){console.log("Map search error: "+JSON.stringify(b)),a.mapResultsCount=0})},a.generateQueryString=function(b){var c,d="",e="",f="",g="";for(var h in b)c=k.generateQueryFromParam(h,b[h]),""!=c&&"index"!==h&&"docid"!==h&&(d=d+k.generateQueryFromParam(h,b[h])+"&"),"q"===h&&(f=b[h]),"source"===h&&(g=b[h]),e+=h+"="+b[h].toString().replace("&","%26")+"&";return d=d.substring(0,d.length-1),"*"!==f&&""!==f||"ROE"!==g||(d+="&sort=country asc,lastname asc"),a.queryString=e,d},a.search(a.generateQueryString(c.search())),a.getFormattedVersion=function(a){var b="";if(Array.isArray(a)){for(var c=0;c<a.length;c++)0!==c&&(b+=", "),b+=a[c];return b}return a},a.getSourceDescription=function(a){var b;switch(a){case"Partner":b='<span class="glyphicon glyphicon-info-sign" > </span>&#160;&#160;The UNCCD Knowledge Portal SKBP connects to various knowledge bases of our partners, containing relevant SLM best practices and scientific knowledge to allow users to search for the required data. <a href="#/partners" >More information on SKBP Partners.</a>';break;case"CBW":b='<span class="glyphicon glyphicon-info-sign" > </span>&#160;&#160;The UNCCD Capacity Building Marketplace brings together needs and possible solutions, linking demand for and supply of capacity building within the framework of the UNCCD for all concerned directly or otherwise with the UNCCD process. Various offerings of the Capacity Building Marketplace are shared through the Knowledge Portal SKPB. <a href="http://www.unccd.int/marketplace" target="_blank">Visit the Marketplace for more.</a>';break;case"ROE":b='<span class="glyphicon glyphicon-info-sign" > </span>&#160;&#160;The Roster of independent Experts has been established in accordance with article 24, paragraph 2, of the Convention. It is maintained and managed by the UNCCD Secretariat. In the future all information regarding the Roster of Experts will be made available through the UNCCD Knowledge Portal SKPB. <a href="http://www.unccd.int/en/programmes/Science/Roster-of-Experts/Pages/default.aspx" target="_blank">More information on the Roster of Experts</a>';break;case"KB":b='<span class="glyphicon glyphicon-info-sign" > </span>&#160;&#160;The SKBP Knowledge Base interactive map provides an overview of knowledge bases and websites reported by country Parties in biannual reports submitted to the UNCCD secretariat.  Information below is based on the reports up the last reporting cycle in 2014, and searchable by Reporting Entity, by Country Coverage of the knowledge base and Country Location of the knowledge base.';break;default:console.log("No resource selected")}return b},a.isSourceSelected=function(){var a=!1;return c.search().source&&(a=!0),a},a.setResultsMode=function(b){b.resultsMode?"map"===b.resultsMode?a.changeResultsMode("map",!1):a.changeResultsMode("list",!1):b.source?"KB"===b.source||"ROE"===b.source?a.changeResultsMode("map",!0):a.changeResultsMode("list",!0):a.changeResultsMode("list",!1)},a.setResultsMode(c.search()),a.sourceDescription=a.getSourceDescription(c.search().source),a.items=a.currentResultItem,a.openModal=function(){var b=g.open({animation:!1,templateUrl:"views/directives/myModalContent.html",controller:"ModalInstanceController",resolve:{items:function(){return a.items}}});b.result.then(function(b){a.selected=b,console.log("Modal ok at: "+new Date),c.search("docid",null)},function(){console.log("Modal dismissed at: "+new Date),c.search("docid",null)})},a.exportXml=function(){var b=""+j.url+"/"+j.collectionName+"/"+j.getSearchHandlerName(c.search().source)+"?"+a.generateQueryString(c.search())+"&wt=xml";l.open(b,"_blank")}}]),unccdApp.controller("aboutController",["$scope",function(a){}]),unccdApp.controller("guidesController",["$scope",function(a){}]),unccdApp.controller("partnersController",["$scope",function(a){}]),unccdApp.controller("advancedSearchController",["$scope","$location",function(a,b){a.advSources=["SKBP Partners","Capacity Building Marketplace","Roster of Experts","Knowledge Bases"],a.advSelectedSource="",a.advLanguages=[{lang:"English",code:"en"},{lang:"Spanish",code:"es"},{lang:"German",code:"de"},{lang:"Italian",code:"it"},{lang:"French",code:"fr"}],a.selectedLang=a.advLanguages[0],a.skbpFields=[{name:"langname",value:"",type:"langSelect",needsAppend:!1},{name:"title",value:"",type:"string",needsAppend:!0},{name:"description",value:"",type:"string",needsAppend:!0},{name:"abstract",value:"",type:"string",needsAppend:!0},{name:"body",value:"",type:"string",needsAppend:!0},{name:"published",valueTo:"",valueFrom:"",type:"year",pFrom:"From year",pTo:"To year",needsAppend:!0}],a.cbwFields=[{name:"langname",value:"",type:"langSelect",needsAppend:!1},{name:"title",value:"",type:"string",needsAppend:!0},{name:"body",value:"",type:"string",needsAppend:!0}],a.roeFields=[{name:"firstname",value:"",type:"string",needsAppend:!1},{name:"lastname",value:"",type:"string",needsAppend:!1},{name:"institution",value:"",type:"string",needsAppend:!1},{name:"workexperience",value:"",type:"string",needsAppend:!1}],a.kbFields=[{name:"kss",value:"",type:"string",needsAppend:!1},{name:"managingentity",value:"",type:"string",needsAppend:!1}],a.advSubmit=function(){var c="",d="";if(a.advSelectedSource&&""!==a.advSelectedSource){switch(a.advSelectedSource){case"SKBP Partners":c="Partner",d=a.getSkbpFields();break;case"Capacity Building Marketplace":c='"CBW"',d=a.getCbwFields();break;case"Roster of Experts":c='"ROE"',d=a.getRoeFields();break;case"Knowledge Bases":c='"KB"',d=a.getKbFields();break;default:console.log("ERROR: the selected source is incorrect")}b.path("/results").search("source",c).search("fq",d)}},a.getSkbpFields=function(){var b="",c=a.selectedLang.code;b=b+'langname:"'+a.selectedLang.lang+'"',""!=a.getValueFromField(a.skbpFields,"title")[0].value&&(b.length>0&&(b+="+"),b=b+"title_"+c+':"'+a.getValueFromField(a.skbpFields,"title")[0].value+'"'),""!=a.getValueFromField(a.skbpFields,"description")[0].value&&(b.length>0&&(b+="+"),b=b+"description_"+c+':"'+a.getValueFromField(a.skbpFields,"description")[0].value+'"'),""!=a.getValueFromField(a.skbpFields,"abstract")[0].value&&(b.length>0&&(b+="+"),b=b+"abstract_"+c+':"'+a.getValueFromField(a.skbpFields,"abstract")[0].value+'"'),""!==a.getValueFromField(a.skbpFields,"body")[0].value&&(b.length>0&&(b+="+"),b=b+"body_"+c+':"'+a.getValueFromField(a.skbpFields,"body")[0].value+'"');var d=a.getValueFromField(a.skbpFields,"published")[0];if(""!==d.valueFrom||""!==d.valueTo){b.length>0&&(b+="+"),console.log("published: "+JSON.stringify(a.getValueFromField(a.skbpFields,"published")));var e=""!==d.valueFrom?d.valueFrom:"*",f=""!==d.valueTo?d.valueTo:"*";b=b+"yearpublished:{"+e+"+TO+"+f+"}"}return b},a.getCbwFields=function(){var b="",c=a.selectedLang.code;return b=b+'langname:"'+a.selectedLang.lang+'"',""!=a.getValueFromField(a.cbwFields,"title")[0].value&&(b.length>0&&(b="+"+b),b=b+"title_"+c+':"'+a.getValueFromField(a.cbwFields,"title")[0].value+'"'),""!=a.getValueFromField(a.cbwFields,"body")[0].value&&(b.length>0&&(b="+"+b),b=b+"body_"+c+':"'+a.getValueFromField(a.cbwFields,"body")[0].value+'"'),b},a.getRoeFields=function(){var b="";return""!=a.getValueFromField(a.roeFields,"firstname")[0].value&&(b.length>0&&(b="+"+b),b=b+'firstname:"'+a.getValueFromField(a.roeFields,"firstname")[0].value+'"'),""!=a.getValueFromField(a.roeFields,"lastname")[0].value&&(b.length>0&&(b="+"+b),b=b+'lastname:"'+a.getValueFromField(a.roeFields,"lastname")[0].value+'"'),""!=a.getValueFromField(a.roeFields,"institution")[0].value&&(b.length>0&&(b="+"+b),b=b+'institution:"'+a.getValueFromField(a.roeFields,"institution")[0].value+'"'),""!=a.getValueFromField(a.roeFields,"workexperience")[0].value&&(b.length>0&&(b="+"+b),b=b+'workexperience:"'+a.getValueFromField(a.roeFields,"workexperience")[0].value+'"'),b},a.getKbFields=function(){var b="";return""!=a.getValueFromField(a.kbFields,"kss")[0].value&&(b.length>0&&(b="+"+b),b=b+'kss:"'+a.getValueFromField(a.kbFields,"kss")[0].value+'"'),""!=a.getValueFromField(a.kbFields,"managingentity")[0].value&&(b.length>0&&(b="+"+b),b=b+'managingentity:"'+a.getValueFromField(a.kbFields,"managingentity")[0].value+'"'),b},a.getValueFromField=function(a,b){return $.grep(a,function(a){return a.name==b})}}]),unccdApp.directive("resultItemDirective",function(){return{restrict:"AE",replace:"true",templateUrl:"views/directives/resultItemView.html"}}),unccdApp.service("fileUtilityService",["communicationService",function(a){this.getHighlightsFilenames=function(a){for(var b=[],c=a.split("\n"),d=c[0].split(","),e=0;e<d.length;e++)b.push(d[e]);return b},this.getImagesFilenames=function(b){var c=[],d=b.split("\n");if(d[1])for(var e=d[1].split(","),f=0;f<e.length;f++)c.push(a.highlightsDir+"/"+e[f]);return c},this.createHighlightObject=function(a){var b={},c="",d=a.split("\n");if(d.length>2){b.title=d[0],b.url=d[1];for(var e=2;e<d.length;e++)c=c+" "+d[e];b.description=c}else console.log("ERROR. Incorrect highlight file content format: Number of lines lower than 3");return b}}]),unccdApp.service("resultsService",["$sce",function(a){var b=["q","start","rows"];this.usedFilters=[],this.buildFacets=function(a,b,c){var d={};this.usedFilters=[];for(var e in a)a[e].length>0&&(d[e]=this.buildFacet(a[e],c[e],e));for(var e in b)Object.getOwnPropertyNames(b[e]).length>0&&(d[e]=this.buildRangeFacet(b[e],c[e]));return d},this.buildFacet=function(a,b,c){for(var d,e=[],f=0;f<a.length;f+=2)b&&this.isInString(a[f],b)?(d=!0,this.usedFilters.push({field:c,value:a[f]})):d=!1,e.push({name:a[f],count:a[f+1],enabled:d});return e},this.buildRangeFacet=function(a,b){var c=a.counts,d=[];a.before>0&&d.push({name:"Before "+a.start,count:a.before,enabled:this.isDateParam(b),from:null,to:a.start});for(var e=0;e<c.length;e+=2)c[e+2]?d.push({name:"From "+c[e]+" to "+c[e+2],count:c[e+1],enabled:this.isDateParam(b),from:c[e],to:c[e+2]}):d.push({name:"From "+c[e]+" to "+(parseInt(c[e])+a.gap),count:c[e+1],enabled:this.isDateParam(b),from:c[e],to:a.end});return a.after>0&&d.push({name:"After "+a.end,count:a.after,enabled:this.isDateParam(b),from:a.end,to:null}),d},this.removeRefiner=function(a,b){var c=b.replace(a+",","");if(b===c){c="";for(var d=b.split(","),e=0;e<d.length-1;e++)c+=d[e],e!=d.length-2&&(c+=",")}return c},this.isNonFacetParam=function(a){var c=!1;return b.indexOf(a)>-1&&(c=!0),c},this.generateQueryFromParam=function(a,b){var c="";if(a&&b&&""!=b)if("q"===a&&(c="q="+b),"fq"===a&&(c="fq="+b),"sort"===a)c="sort="+config.sortsMap[b];else if(this.isNonFacetParam(a))c=a+"="+b;else if(this.isDateParam(b))c="fq="+a+":"+b;else if("resultsMode"===a);else for(var d=b.split(","),e=0;e<d.length;e++){var f=this.decodeRefiner(d[e]);f=f.replace("&","%26"),config.multipleFacets.indexOf(a)<0?c=c+"fq="+a+":"+f:(c=0===e?c+"fq={!tag="+a+"F}"+a+":("+f:c+" OR "+f,e===d.length-1&&(c+=")"))}else if("q"===a)return"q=*";return c},this.encodeDateRefiner=function(a,b){var c="[";return c+=a?a:"*",c+="+TO+",c+=b?b:"*",c+="}"},this.isDateParam=function(a){var b=!1;return a&&a.match&&(a.match(/\[(.*?)\}/)||a.match(/\[(.*?)\]/)||a.match(/\{(.*?)\]/)||a.match(/\{(.*?)\}/))&&(b=!0),b},this.isInString=function(a,b){b=""+b;for(var c=!1,d=b.split(","),e=0;e<d.length&&!c;e++)this.encodeRefiner(a)===d[e]&&(c=!0);return c},this.encodeRefiner=function(a){var b=a;return b=b.replace(",","%2C")},this.decodeRefiner=function(b){var c=(angular.element("<textarea />").html(b).text(),a.getTrustedUrl(a.trustAsUrl(b)));return c=c.replace("%25","%"),c=c.replace(" ","+"),c.indexOf('"')<0&&(c='"'+c+'"'),c}}]),unccdApp.controller("contactController",["$scope",function(a){}]),unccdApp.controller("disclaimerController",["$scope",function(a){}]),unccdApp.controller("ModalInstanceController",["$scope","$modalInstance","items",function(a,b,c){a.items=c,a.currentResultItem=c,a.selected={item:a.items},a.ok=function(){b.close(a.selected.item)},a.cancel=function(){b.dismiss("cancel")},a.getFormattedVersion=function(a){var b="";if(Array.isArray(a)){for(var c=0;c<a.length;c++)0!==c&&(b+=", "),b+=a[c];return b}return a}}]),unccdApp.controller("headerController",["$scope","$route",function(a,b){a.$route=b,console.log("route: "+JSON.stringify(b.current.$$route.activeTab))}]),unccdApp.controller("footerController",["$scope",function(a){a.disclaimer="Disclaimer",a.contact="Contact"}]),unccdApp.directive("searchInputDirective",function(){return{restrict:"AE",replace:"true",templateUrl:"views/directives/searchInputView.html"}}),unccdApp.service("communicationService",["$cookieStore","$resource","localStorageService",function(a,b,c){this.url=config.url,this.collectionName=config.collectionName,this.searchHandler=config.searchHandler,this.highlightsDir=config.highlightsDir,this.autocompleteHandler=config.autocompleteHandler,this.sorts=config.sorts,this.getUrl=function(){return this.url},this.getSearchHandlerName=function(a,b){var c="select";switch(a){case"Partner":c=b?"partnerdetail":"partner";break;case"CBW":c="cbw";break;case"ROE":c="roe";break;case"KB":c="kb";break;default:c="select"}return c},this.getMapHandlerName=function(a){var b="selectmap";switch(a){case"Partner":b="partnermap";break;case"CBW":b="cbwmap";break;case"ROE":b="roemap";break;case"KB":b="kbmap";break;default:b="selectmap"}return b},this.getAutocompleteHandler=function(){return this.autocompleteHandler},this.search=b(""+this.url+"/"+this.collectionName+"/"+this.searchHandler+"?:query",{},{get:{method:"GET",headers:{"Content-Type":"application/json"}}}),this.getFile=b(""+this.url+"/"+this.highlightsDir+"/fileNames.txt",{},{get:{method:"GET",headers:{"Content-Type":"text/plain"}}})}]),unccdApp.directive("headerDirective",function(){return{restrict:"AE",replace:"true",templateUrl:"views/directives/headerView.html"}}),unccdApp.directive("footerDirective",function(){return{restrict:"AE",replace:"true",templateUrl:"views/directives/footerView.html"}}),unccdApp.controller("searchInputController",["$scope","$location","$route","$http","localStorageService","communicationService",function(a,b,c,d,e,f){a.inputValue="",a.selectedSource="",a.sources=["SKBP Partners","Capacity Building Marketplace","Roster of Experts","Knowledge Bases"],a.autocompleteValues=[],a.sorts=f.sorts,a.selectedSort=a.sorts[0],a.rows=config.rows,a.selectedRows=a.rows[0],a.submit=function(){b.$$search={},e.set("query",a.inputValue),""===a.selectedSource?b.path("/results").search("q",a.inputValue).search("sort",a.selectedSort).search("rows",a.selectedRows):b.path("/results").search("q",a.inputValue).search("sort",a.selectedSort).search("rows",a.selectedRows).search("source",a.getSource(a.selectedSource))},"/results"==b.path()&&b.search().q&&""!==b.search().q&&(a.inputValue=b.search().q),a.getSource=function(a){var b;switch(a){case"SKBP Partners":b="Partner";break;case"Capacity Building Marketplace":b="CBW";break;case"Roster of Experts":b="ROE";break;case"Knowledge Bases":b="KB";break;default:console.log("ERROR: the selected source is incorrect")}return b},a.getSourceString=function(a){var b;switch(a){case"Partner":b="SKBP Partners";break;case"CBW":b="Capacity Building Marketplace";break;case"ROE":b="Roster of Experts";break;case"KB":b="Knowledge Bases";break;default:console.log("ERROR: the source is incorrect")}return b},b.search().source&&(a.selectedSource=a.getSourceString(b.search().source)),b.search().sort&&(a.selectedSort=b.search().sort),b.search().rows&&(a.selectedRows=b.search().rows),a.getAutocompleteQuery=function(a){return"terms.fl=keywords&terms.prefix="+a+"&terms.sort=count&wt=json"},a.generateAutocompleteValues=function(){d.get(""+f.url+"/"+f.collectionName+"/"+f.getAutocompleteHandler()+"?"+a.getAutocompleteQuery(a.inputValue),{},{}).success(function(b){b.terms&&b.terms.keywords&&(a.autocompleteValues=a.getEvenValues(b.terms.keywords))}).error(function(a){console.log("ERROR: Unable to get autocomplete data: "+JSON.stringify(a))})},a.getEvenValues=function(a){if(a&&a.length>0){for(var b=[],c=0;c<a.length;c+=2)b.push(a[c]);return b}return a}}]),unccdApp.directive("searchPromoDirective",function(){return{restrict:"AE",replace:"true",templateUrl:"views/directives/searchPromoView.html"}}),unccdApp.controller("searchPromoController",["$scope","$http","communicationService",function(a,b,c){a.resultsCount=0,a.getDocsCount=function(){a.loading=!0,b.get(""+c.url+"/"+c.collectionName+"/"+c.getSearchHandlerName()+"?q=*&rows=1",{},{}).success(function(b){b.response&&b.response.numFound?a.resultsCount=b.response.numFound:console.log("ERROR - Error getting the documents count: Count value is not in the response")}).error(function(a){console.log("ERROR - Error getting the documents count: "+JSON.stringify(a))})},a.getDocsCount()}]),unccdApp.directive("partnerLogosDirective",function(){return{restrict:"AE",replace:"true",templateUrl:"views/directives/partnerLogosView.html"}}),unccdApp.controller("partnerLogosController",["$scope","$location","$route","localStorageService",function(a,b,c,d){}]),unccdApp.directive("infowindow",function(){return{restrict:"E",templateUrl:"views/directives/infoWindowView.html"}}),angular.module("unccdApp").run(["$templateCache",function(a){a.put("views/directives/footerView.html",'<footer> <div class="container"> <div class="row unccd-color-silver"> <div class="col-md-6"> <p> <span class="unccd-color-silver-light">© 2015 UNCCD. All Rights Reserved.</span><br> <a href="#/disclaimer">Terms of Use</a> | <a href="#/contact">Contact</a> </p> </div> <div class="col-md-6 text-right"> <p> United Nations Convention to Combat Desertification<br> UNCCD Secretariat<br> P.O. Box 260129<br> D-53153 Bonn, Germany<br> <a href="mailto:skbp@unccd.int" title="Mail us">skbp@unccd.int</a> </p> </div> </div> </div> </footer><!-- /.footer Note: avaible {{disclaimer}} {{contact}} -->'),a.put("views/directives/headerView.html",'<nav class="navbar unccd-navbar"> <!-- Container --> <div class="container"> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed unccd-navbar-toggle" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="#/"><img src="images/logo-unccd.70f0a0d5.png" alt="UNCCD" class="img-responsive"></a> </div> <div id="navbar" class="collapse navbar-collapse"> <!--<h3 class="unccd-color-brown">Scientific Knowledge Brokering Portal</h3>--> <ul class="nav navbar-nav navbar-left unccd-navbar-nav unccd-color-brown"> <li ng-class="{active: $route.current.$$route.activeTab == \'home\'}"><a href="#/">Home</a></li> <!--<li ng-class="{active: $route.current.$$route.activeTab == \'results\'}"><a href="#/results">Results</a></li>--> <li ng-class="{active: $route.current.$$route.activeTab == \'about\'}"><a href="#/about">About</a></li> <!--<li ng-class="{active: $route.current.$$route.activeTab == \'guides\'}"><a href="#/guides">Guides</a></li>--> <li ng-class="{active: $route.current.$$route.activeTab == \'partners\'}"><a href="#/partners">Partners</a></li> <!--<li class="unccd-navbar-nav-lang unccd-color-gray"><a href="#contact">Language</a></li>--> </ul> <ul class="nav navbar-nav navbar-right unccd-navbar-nav unccd-navbar-nav-lang"> <li id="google_translate_element"></li> </ul> </div><!--/.nav-collapse --> <span class="unccd-header-title">Scientific Knowledge<br> Brokering Portal</span> </div><!--/.container --> </nav><!--/.navbar -->'),a.put("views/directives/infoWindowView.html",'<!--<h4>\r\n    <span class="glyphicon glyphicon-globe unccd-color-green"> </span>&#160;&#160;\r\n    <a href="{{place.url}}" title="{{place[\'title_en\']}}" class="unccd-color-green">{{place[\'title_en\']}}</a>\r\n</h4>\r\n<a class="btn btn-default unccd-color-green" role="button" data-toggle="modal" data-target="#resultItemModal" ng-click="prepareResultModal(place.listPosition)">\r\n    View details &raquo;\r\n</a>--> <h4> <span class="unccd-format-icons"> <span class="glyphicon glyphicon-globe unccd-color-green" ng-if="place.format == \'HTML\'"> </span> <span class="glyphicon glyphicon-globe unccd-color-green" ng-if="place.format  == \'Web Page\'"> </span> <span class="fa fa-file-pdf-o unccd-color-green" ng-if="place.format  == \'Adobe PDF\'"> </span> <span class="fa fa-file-word-o unccd-color-green" ng-if="place.format  == \'Word\'"> </span> <span class="fa fa-file-image-o unccd-color-green" ng-if="place.format  == \'Image\'"> </span> <span class="fa fa-file-powerpoint-o unccd-color-green" ng-if="place.format  == \'PowerPoint\'"> </span> <span class="fa fa-question unccd-color-green" ng-if="place.format  == \'Unknown\'"> </span> </span> <!--<a href="{{place.url}}{{place.website}}" title="" class="unccd-color-green">--> <a href="" title="" class="unccd-color-green" data-toggle="modal" data-target="#resultItemModal" ng-click="prepareResultModalWithId(currentId)"> {{place.id}}{{place.title_en}}{{place.title_es}}{{place.title_de}}{{place.title_it}}{{place.title_fr}}{{place.kss}}{{place.persontitle}} {{place.firstname}} {{place.lastname}}</a> </h4> <p class="unccd-color-gray">{{place.published | date:\'yyyy-MM-dd\'}}</p> <p class="unccd-color-gray" ng-if="place.abstract_en || place.abstract_es || place.abstract_de || place.abstract_it || place.abstract_fr || place.nationality || place.managingentity"> {{place.abstract_en}}{{place.abstract_es}}{{place.abstract_de}}{{place.abstract_it}}{{place.abstract_fr}}{{place.nationality}}{{place.managingentity}} </p> <p ng-if="place.disciplines || place.topics"> {{getFormattedVersion(place.disciplines)}}{{getFormattedVersion(place.topics)}} </p> <p> <a class="btn btn-default unccd-color-green" role="button" ng-click="prepareResultModalWithId(currentId)">View details &raquo;</a> </p>'),
a.put("views/directives/myModalContent.html",'<!--\r\n<div class="modal-header">\r\n    <h3 class="modal-title">I\'m a modal!</h3>\r\n</div>\r\n<div class="modal-body">\r\n    <ul>\r\n        <li ng-repeat="item in items">\r\n            <a href="#" ng-click="$event.preventDefault(); selected.item = item">{{ item }}</a>\r\n        </li>\r\n    </ul>\r\n    Selected: <b>{{ selected.item }}</b>\r\n</div>\r\n<div class="modal-footer">\r\n    <button class="btn btn-primary" type="button" ng-click="ok()">OK</button>\r\n    <button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button>\r\n</div>\r\n--> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()"> <span aria-hidden="true">&times;</span> </button> <h3 class="modal-title"> <div ng-if="currentResultItem[\'title_\' + currentResultItem.language]"> {{currentResultItem[\'title_\' + currentResultItem.language]}} </div> <div ng-if="!currentResultItem[\'title_\' + currentResultItem.language]"> {{currentResultItem.title_en}} </div> {{currentResultItem.kss}} {{currentResultItem.persontitle}} {{currentResultItem.firstname}} &#160;{{currentResultItem.lastname}} </h3> </div> <div class="modal-body"> <div ng-repeat="(key, value) in currentResultItem"> <p ng-if="key === \'url\' || key === \'website\'"><strong>{{key | translate}}:</strong> <a href="{{value}}" target="_blank">{{ getFormattedVersion(value) }}</a></p> <p ng-if="key !== \'url\' && key !== \'website\' && key !== \'id\' && key !== \'language\'"><strong>{{key | translate}}:</strong> {{ getFormattedVersion(value) }}</p> </div> </div> <div class="modal-footer"> <form id="loginForm" method="post" class="form-horizontal"> <button type="button" class="btn" ng-click="ok()">OK</button> </form> </div>'),a.put("views/directives/partnerLogosView.html",'<div class="container unccd-partners unccd-content"> <div class="row"> <div class="col-md-12"> <a href="#/partners" title="FAO AGRIS International Information System for the Agricultural Science and Technology"><img src="images/logo-agris.12839aae.png" alt="AGRIS"></a> <a href="#/partners" title="ISRIC - World Soil Information"><img src="images/logo-isric.2e575df8.png" alt="ISRIC"></a> <a href="#/partners" title="La Agencia Estatal Consejo Superior de Investigaciones Científicas (CSIC)"><img src="images/logo-csic.c18b0071.png" alt="CSIC"></a> <a href="#/partners" title="FAO TECA Technologies and practices for small agricultural producers"><img src="images/logo-teca.e0aa5cb0.png" alt="TECA"></a> <a href="#/partners" title="The Jornada Rangeland Research programs"><img src="images/logo-usda.d4746a61.png" alt="USDA-ARS Jornada"></a> <a href="#/partners" title="World Overview of Conservation Approaches and Technologies"><img src="images/logo-wocat.74b913ee.png" alt="WOCAT"></a> </div> </div> </div>'),a.put("views/directives/resultItemView.html",'<div class="modal fade" id="resultItemModal" tabindex="-1" role="dialog" aria-labelledby="resultItemModal" aria-hidden="true"> <div class="modal-dialog"> <!--\r\n    RESULT ITEM MODAL\r\n    For more info read the documentation in the app/components/results/resultItemDirective.js file\r\n    --> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> <h3 class="modal-title"> {{currentResultItem.title_en}} {{currentResultItem.title_es}} {{currentResultItem.title_de}} {{currentResultItem.title_it}} {{currentResultItem.title_fr}} {{currentResultItem.kss}} {{currentResultItem.persontitle}} {{currentResultItem.firstname}} &#160;{{currentResultItem.lastname}} </h3> </div> <div class="modal-body"> <div ng-repeat="(key, value) in currentResultItem"> <!-- Create a link if the item is a url or website --> <p ng-if="key === \'url\' || key === \'website\'"><strong>{{key | translate}}:</strong> <a href="{{value}}" target="_blank">{{ getFormattedVersion(value) }}</a></p> <p ng-if="key !== \'url\' && key !== \'website\'"><strong>{{key | translate}}:</strong> {{ getFormattedVersion(value) }}</p> </div> </div> <div class="modal-footer"> <form id="loginForm" method="post" class="form-horizontal"> <button type="button" class="btn" data-dismiss="modal">OK</button> </form> </div> </div><!-- /.modal-content --> </div><!-- /.modal-dialog --> </div>'),a.put("views/directives/searchInputView.html",'<div ng-controller="searchInputController"> <form class="navbar-form unccd-clear-shadow" role="search"> <div class="input-group unccd-clear-input unccd-search-input"> <!--<input type="text" class="form-control" placeholder="Search for..." name="srch-term" id="srch-term" ng-model="inputValue" ng-change="generateAutocompleteValues()"/>--> <input type="text" class="form-control" ng-model="inputValue" placeholder="Search for..." typeahead="autocompleteValue for autocompleteValue in autocompleteValues" typeahead-loading="loadingLocations" typeahead-no-results="noResults" class="form-control" ng-change="generateAutocompleteValues()"> <span class="input-group-btn"> <button class="btn btn-default" type="submit" ng-click="submit()"><span class="glyphicon glyphicon-search"> </span></button> </span> </div> <div class="btn-group unccd-sources"> <select class="form-control unccd-set-radius unccd-clear-shadow unccd-border-color-white" ng-model="selectedSource" ng-options="source for source in sources" style="max-width: 180px"> <option style="display:none" value="" disabled selected>Sources</option> </select> </div> </form> </div>'),a.put("views/directives/searchPromoView.html",'<div ng-controller="searchPromoController"> <h3><span class="unccd-segoe-ui-semi-bold">{{resultsCount | number}}</span> searchable items</h3> <!-- //TODO this count is probably something that should be dynamic --> <h4> Search <span class="unccd-segoe-ui-semi-bold">Knowledge Bases</span> around the world, and various <span class="unccd-segoe-ui-semi-bold">Best Practices</span> and <span class="unccd-segoe-ui-semi-bold">Publications</span> from our scientific partners. </h4> </div>'),a.put("views/partials/aboutView.html",'<!-- Search area --> <div class="jumbotron unccd-clear-mg unccd-clear-pd unccd-jumbotron"> <div class="container"> <div class="row"> <div class="col-md-8 unccd-search"> <div data-search-input-directive></div> <a href="#/advancedSearch" title="Advanced search" class="unccd-advanced-search-link unccd-color-white">Advanced search</a> <div class="clearfix"> </div> </div> <div class="col-md-4 unccd-promo unccd-segoe-ui-light unccd-color-white"> <div data-search-promo-directive></div> </div> </div> </div> </div><!-- /.search area --> <!-- Content --> <div class="unccd-content unccd-page"> <div class="container"> <div class="row"> <!-- Static content --> <div class="col-md-12"> <h3 class="unccd-segoe-ui-normal">The UNCCD Knowledge Portal SKBP</h3> <p> Addressing land degradation, through restoration, mitigation and sustainable land management, requires a lot of knowledge, capacity and resources. Often that knowledge and those resources are very specific for local circumstances. Meanwhile there are many sources available for that knowledge and those resources. How do we ensure this information reaches the right people? How do we find our way through the many sources, websites and knowledge bases available? The UNCCD Knowledge Portal addresses that issue.<br> The SKBP Search portal includes a search interface, providing awareness, guidance and access to various knowledge sources, including: </p> <ul> <li>A large selection of literature and articles from our various partners</li> <li>The UNCCD roster of Experts</li> <li>The interactive maps of knowledge systems</li> <li>Best Practices</li> <li>The UNCCD Capacity Building Marketplace</li> </ul> <h4>See also:</h4> <p><a href="http://www.unccd.int/knowledge">UNCCD.int/knowledge</a></p> </div><!-- /.static content --> </div> </div> </div><!-- /.content --> <!-- Partners --> <div data-partner-logos-directive></div><!-- /.partners -->'),a.put("views/partials/advancedSearchView.html",'<!-- Search area --> <div class="jumbotron unccd-clear-mg unccd-clear-pd unccd-jumbotron"> <div class="container"> <div class="row"> <div class="col-md-8 unccd-search"> <div data-search-input-directive></div> <a href="#/advancedSearch" title="Advanced search" class="unccd-advanced-search-link unccd-color-white">Advanced search</a> <div class="clearfix"> </div> </div> <div class="col-md-4 unccd-promo unccd-segoe-ui-light unccd-color-white"> <div data-search-promo-directive></div> </div> </div> </div> </div><!-- /.search area --> <!-- Content --> <div class="unccd-content unccd-page"> <div class="container"> <div class="row"> <div class="col-md-12"> <h3 class="unccd-segoe-ui-normal">Advanced search</h3><br> <!-- Advanced search container --> <div class="unccd-advanced-search"> <!-- Sources --> <form class="form-inline unccd-advanced-search-sources-select"> <fieldset> <label class="control-label"> Select your source:&#160;&#160; </label> <select class="form-control unccd-set-radius" ng-model="advSelectedSource" ng-options="advSource for advSource in advSources"> <option style="display:none" value="" disabled selected>Sources</option> </select> </fieldset> </form><!--/.sources --> <!-- Fields --> <form class="form-horizontal unccd-advanced-search-sources"> <div ng-if="advSelectedSource === \'SKBP Partners\'" class="row"> <div class="col-md-4" ng-repeat="skbpField in skbpFields"> <fieldset> <label class="control-label">{{skbpField.name | translate}}</label> <input ng-if="skbpField.type !== \'langSelect\' && skbpField.type !== \'year\'" type="text" name="skbpField.name" class="form-control" ng-model="skbpField.value"> <select ng-if="skbpField.type === \'langSelect\'" class="form-control" ng-model="selectedLang" ng-options="lang.lang for lang in advLanguages"> <!--<option style="display:none" value="" disabled selected>Select language</option>--> </select> <input ng-if="skbpField.type == \'year\'" type="text" name="skbpField.name" class="form-control" ng-model="skbpField.valueFrom" placeholder="{{skbpField.pFrom}}" style="margin-bottom: 30px"> <input ng-if="skbpField.type == \'year\'" type="text" name="skbpField.name" class="form-control" ng-model="skbpField.valueTo" placeholder="{{skbpField.pTo}}"> </fieldset> </div> <div class="clearfix"> </div><br> </div> <div ng-if="advSelectedSource === \'Capacity Building Marketplace\'" class="row"> <div class="col-md-4" ng-repeat="cbwField in cbwFields"> <fieldset> <label class="control-label">{{cbwField.name | translate}}</label> <!-- Selects between an input and a select, if is a language field, then shows a select --> <input ng-if="cbwField.type !== \'langSelect\'" type="text" name="cbwField.name" class="form-control" ng-model="cbwField.value"> <select ng-if="cbwField.type === \'langSelect\'" class="form-control" ng-init="selectedLang = advLanguages[0]" ng-model="selectedLang" ng-options="lang.lang for lang in advLanguages"> <!--<option style="display:none" value="" disabled selected>Select language</option>--> </select> </fieldset> </div> <div class="clearfix"> </div><br> </div> <div ng-if="advSelectedSource === \'Roster of Experts\'" class="row"> <div class="col-md-4" ng-repeat="roeField in roeFields"> <fieldset> <label class="control-label">{{roeField.name | translate}}</label> <input type="text" name="roeField.name" class="form-control" ng-model="roeField.value"> <select ng-if="roeField.type === \'langSelect\'" class="form-control" ng-init="selectedLang = advLanguages[0]" ng-model="selectedLang" ng-options="lang.lang for lang in advLanguages"> <!--<option style="display:none" value="" disabled selected>Select language</option>--> </select> </fieldset> </div> <div class="clearfix"> </div><br> </div> <div ng-if="advSelectedSource === \'Knowledge Bases\'" class="row"> <div class="col-md-4" ng-repeat="kbField in kbFields"> <fieldset> <label class="control-label">{{kbField.name | translate}}</label> <input type="text" name="kbField.name" class="form-control" ng-model="kbField.value"> <select ng-if="kbField.type === \'langSelect\'" class="form-control" ng-init="selectedLang = advLanguages[0]" ng-model="selectedLang" ng-options="lang.lang for lang in advLanguages"> <!--<option style="display:none" value="lang.code" disabled selected>Select language</option>--> </select> </fieldset> <div class="clearfix"> </div><br> </div> </div> <input style="display: none" type="submit" ng-click="advSubmit()"> <a class="btn btn-success unccd-color-white" role="button" type="submit" ng-click="advSubmit()">Search</a> </form><!--/.fields--> </div><!--/.advanced search container --> </div> </div> </div> </div><!-- /.content --> <!-- Partners --> <div data-partner-logos-directive></div><!-- /.partners -->'),a.put("views/partials/contactView.html",'<!-- Search area --> <div class="jumbotron unccd-clear-mg unccd-clear-pd unccd-jumbotron"> <div class="container"> <div class="row"> <div class="col-md-8 unccd-search"> <div data-search-input-directive></div> <a href="#/advancedSearch" title="Advanced search" class="unccd-advanced-search-link unccd-color-white">Advanced search</a> <div class="clearfix"> </div> </div> <div class="col-md-4 unccd-promo unccd-segoe-ui-light unccd-color-white"> <div data-search-promo-directive></div> </div> </div> </div> </div><!-- /.search area --> <!-- Content --> <div class="unccd-content unccd-page"> <div class="container"> <div class="row"> <!-- Static content --> <div class="col-md-12"> <h3 class="unccd-segoe-ui-normal">Contact info</h3> <p> Are you interested to become a partner and get involved in this project? Please contact us, using the information below:<br><br> United Nations Convention to Combat Desertification<br> UNCCD Secretariat<br> P.O. Box 260129<br> D-53153 Bonn, Germany<br> For information regarding the Scientific Knowledge Brokering Portal: <a href="mailto:skbp@unccd.int" target="_top">skbp@unccd.int</a><br> </p> </div><!-- /.static content --> </div> </div> </div><!-- /.content --> <!-- Partners --> <div data-partner-logos-directive></div><!-- /.partners -->'),a.put("views/partials/disclaimerView.html",'<!-- Search area --> <div class="jumbotron unccd-clear-mg unccd-clear-pd unccd-jumbotron"> <div class="container"> <div class="row"> <div class="col-md-8 unccd-search"> <div data-search-input-directive></div> <a href="#/advancedSearch" title="Advanced search" class="unccd-advanced-search-link unccd-color-white">Advanced search</a> <div class="clearfix"> </div> </div> <div class="col-md-4 unccd-promo unccd-segoe-ui-light unccd-color-white"> <div data-search-promo-directive></div> </div> </div> </div> </div><!-- /.search area --> <!-- Content --> <div class="unccd-content unccd-page"> <div class="container"> <div class="row"> <!-- Static content --> <div class="col-md-12"> <h3 class="unccd-segoe-ui-normal">Disclaimer</h3> <p> The boundaries and names shown and the designations used on this map do not imply official endorsement or acceptance by the United Nations Convention to Combat Desertification (UNCCD) and the United Nations. Care was taken in the creation of this map. The UNCCD, its staff and contractors cannot accept any responsibility for errors, omissions, or positional accuracy or be held responsible for any damages due to errors or omissions in these maps. Depiction of boundaries is not authoritative. There are no warranties, expressed or implied, including the warranty of merchantability or fitness for a particular purpose, accompanying these maps. However, notification of any errors will be appreciated. </p> <p> These pages may contain links and references to third-party web-sites. The UNCCD secretariat provides these links only as a convenient service. The inclusion of a link or reference does not imply the endorsement of the linked site by the UNCCD secretariat. </p> <h4>See also:</h4> <p><a href="http://www.unccd.int/en/Pages/terms-of-use.aspx" title="UNCCD website terms of use" target="_blank">UNCCD website terms of use</a> </p></div><!-- /.static content --> </div> </div> </div><!-- /.content --> <!-- Partners --> <div data-partner-logos-directive></div><!-- /.partners -->'),a.put("views/partials/guidesView.html",'<!-- Search area --> <div class="jumbotron unccd-clear-mg unccd-clear-pd unccd-jumbotron"> <div class="container"> <div class="row"> <div class="col-md-8 unccd-search"> <div data-search-input-directive></div> <a href="#/advancedSearch" title="Advanced search" class="unccd-advanced-search-link unccd-color-white">Advanced search</a> <div class="clearfix"> </div> </div> <div class="col-md-4 unccd-promo unccd-segoe-ui-light unccd-color-white"> <div data-search-promo-directive></div> </div> </div> </div> </div><!-- /.search area --> <!-- Content --> <div class="unccd-content unccd-page"> <div class="container"> <div class="row"> <!-- Static content --> <div class="col-md-12"> <h3 class="unccd-segoe-ui-normal">Guides</h3> <p> Guides page ... </p> </div><!-- /.static content --> </div> </div> </div><!-- /.content --> <!-- Partners --> <div data-partner-logos-directive></div><!-- /.partners -->'),a.put("views/partials/homeView.html",'<!-- Search area --> <div class="jumbotron unccd-clear-mg unccd-clear-pd unccd-jumbotron"> <div class="container"> <div class="row"> <div class="col-md-8 unccd-search"> <div data-search-input-directive></div> <a href="#/advancedSearch" title="Advanced search" class="unccd-advanced-search-link unccd-color-white">Advanced search</a> <div class="clearfix"> </div> </div> <div class="col-md-4 unccd-promo unccd-segoe-ui-light unccd-color-white"> <div data-search-promo-directive></div> </div> </div> </div> </div> <!-- /.search area --> <!-- Highlights --> <div class="unccd-highlights unccd-content"> <!-- Container --> <div class="container"> <!-- Row --> <div class="row"> <!-- Carousel --> <ul id="unccd-highlights-carousel" class="list-unstyled" ng-show="showCarousel"> <li class="col-md-4" ng-repeat="highlight in highlights"> <h4 class="unccd-segoe-ui-normal"><a href="{{highlight.url}}" title="{{highlight.title}}">{{highlight.title}}</a></h4> <p>{{highlight.description}}</p> <!--<img ng-src="{{imgHighlights[$index]}}" style="width: 100%; margin-bottom: 10px;">--> <p><a class="btn btn-default" href="{{highlight.url}}" role="button" title="{{highlight.title}}">View details &raquo;</a></p> </li> </ul> <!-- /.Carousel --> <div class="clearfix"></div> <!-- Controlers --> <div class="unccd-highlights-carousel-control unccd-color-silver unccd-clear-decoration" ng-show="showCarousel"> <a id="prev" class="prev glyphicon glyphicon-circle-arrow-left" href="#" ng-show="showCarousel"> </a> <a id="next" class="next glyphicon glyphicon-circle-arrow-right" href="#" ng-show="showCarousel"> </a> </div> <!-- /.controlers --> </div> <!-- /.row --> </div> <!-- /.container --> </div> <!-- /.highlights --> <!-- Guides --> <!-- Pedro -> Original code is in template of home page if will be needed --> <!-- /.guides --> <!-- Partners --> <div data-partner-logos-directive></div> <!-- /.partners -->'),a.put("views/partials/partnersView.html",'<!-- Search area --> <div class="jumbotron unccd-clear-mg unccd-clear-pd unccd-jumbotron"> <div class="container"> <div class="row"> <div class="col-md-8 unccd-search"> <div data-search-input-directive></div> <a href="#/advancedSearch" title="Advanced search" class="unccd-advanced-search-link unccd-color-white">Advanced search</a> <div class="clearfix"> </div> </div> <div class="col-md-4 unccd-promo unccd-segoe-ui-light unccd-color-white"> <div data-search-promo-directive></div> </div> </div> </div> </div><!-- /.search area --> <!-- Content --> <div class="unccd-content unccd-page"> <div class="container"> <div class="row"> <!-- Static content --> <div class="col-md-12"> <h3 class="unccd-segoe-ui-normal">The UNCCD Scientific Knowledge Brokering Portal</h3> <p> The SKBP pilot centralizes knowledge bases containing relevant SLM best practices and scientific knowledge to allow users to search for the required data. The search portal has been developed with financial contributions from the Spanish and Swiss Governments in addition to the in-kind contributions of five SKBP pilot partners, including: the Spanish National Research Council (CSIC), World Soil Information (ISRIC), World Overview of Conservation Approaches and Technologies (WOCAT), the Technologies and Practices for Small Agricultural Producers (TECA) project of the Food and Agriculture Organization of the United Nations (FAO) and the FAO International System for Agricultural Science and Technology. The Agricultural Research Service of the United States Department of Agriculture has contributed expert knowledge and allowed the UNCCD to leverage many of the tools being developed as part of JournalMap and the global Land-Potential Knowledge System (LandPKS). It has been a leading in-kind contributor to the development of the SKBP pilot interactive web maps. </p> <ul> <li><a href="http://agris.fao.org/agris-search/index.do">Agris</a> FAO AGRIS International Information System for the Agricultural Science and Technology</li> <li><a href="http://www.csic.es/">CSIC</a> La Agencia Estatal Consejo Superior de Investigaciones Científicas (CSIC)</li> <li><a href="http://www.isric.org/">ISRIC</a> ISRIC - World Soil Information</li> <li><a href="http://skbp.unccd.int/">UNCCD</a> United Nations Convention to Combat Desertification</li> <li><a href="http://teca.fao.org/">TECA</a> FAO TECA Technologies and practices for small agricultural producers</li> <li><a href="https://www.wocat.net/">WOCAT</a> World Overview of Conservation Approaches and Technologies</li> <li><a href="http://jornada.nmsu.edu/">USDA-ARS Jornada</a> The Jornada Rangeland Research programs</li> </ul> </div><!-- /.static content --> </div> </div> </div><!-- /.content --> <!-- Partners --> <div data-partner-logos-directive></div><!-- /.partners -->'),a.put("views/partials/resultsView.html",'<!-- Search area --> <div class="jumbotron unccd-clear-mg unccd-clear-pd unccd-jumbotron unccd-jumbotron-results"> <div class="container"> <div class="row"> <div class="col-md-12 unccd-search"> <div data-search-input-directive class="col-md-8 unccd-search"></div> <div class="btn-group unccd-sorts col-md-4 unccd-search" style="margin-bottom: 10px; padding-top: 40px"> <span class="unccd-advanced-search-link unccd-color-white">Sort by: </span> <select class="form-control unccd-set-radius unccd-clear-shadow unccd-border-color-white" ng-model="selectedSort" ng-options="sort for sort in sorts" style="max-width: 120px; display: inline-block"> </select> <span class="unccd-advanced-search-link unccd-color-white" style="margin-left: 10px">Results: </span> <select class="form-control unccd-set-radius unccd-clear-shadow unccd-border-color-white" ng-model="selectedRows" ng-options="row for row in rows" style="max-width: 64px; display: inline-block"> </select> </div> <a style="padding-left: 75px" href="#/advancedSearch" title="Advanced search" class="unccd-advanced-search-link unccd-color-white">Advanced search</a> <div class="clearfix"> </div> </div> </div> </div> </div><!--/.search area --> <!-- Description section --> <div class="container" ng-show="(bigTotalItems > 0) && isSourceSelected()"> <div class="panel panel-default unccd-clear-shadow unccd-clear-border unccd-color-gray unccd-result-description"> <div class="panel-body" ng-bind-html="sourceDescription"> </div> </div> </div><!--/.description section --> <!-- Content --> <div class="container"> <!-- Row --> <div class="row" ng-show="!loading"> <div class="row"> <div class="col-md-9"> <!-- Breadcrumbs --> <ul class="list-unstyled"> <li ng-repeat="filter in usedFilters" style="display: inline"> <a href="" title="{{filter.field| trusted}}" ng-click="facetSelected(filter.field, filter.value, null, null)">{{filter.field| translate}}: {{filter.value}}</a> <span class="glyphicon glyphicon-remove" style="margin-right: 5px; color:red"></span> </li> </ul> <!-- End breadcrumbs --> </div> <div class="col-md-3 text-right"><a href="" title="export as xml" ng-click="exportXml()">export as xml</a></div> </div> <!-- Facets --> <div class="col-md-3 unccd-facets"> <!-- Switch --> <div class="unccd-facets-switch unccd-facets-title" role="group" aria-label="mode"> <button type="button" class="btn btn-default unccd-color-green" ng-class="{active: resultsMode == \'list\'}" ng-click="changeResultsMode(\'list\', true)">List</button> <button type="button" class="btn btn-default unccd-color-green" ng-class="{active: resultsMode == \'map\', disabled: mapResultsCount == 0}" ng-disabled="mapResultsCount == 0" ng-click="changeResultsMode(\'map\', true)">Map</button> </div><!--/.switch --> <ul class="list-unstyled unccd-facets-list unccd-color-gray"> <li class="unccd-facets-title" ng-repeat="(title, refiners) in facets"><strong>{{title| translate}}</strong> <ul class="list-unstyled"> <li ng-repeat="refiner in refiners"> <span class="unccd-format-icons"> <span class="glyphicon glyphicon-globe unccd-color-green" ng-if="refiner.name == \'HTML\'"> </span> <span class="glyphicon glyphicon-globe unccd-color-green" ng-if="refiner.name == \'Web Page\'"> </span> <span class="fa fa-file-pdf-o unccd-color-green" ng-if="refiner.name == \'Adobe PDF\'"> </span> <span class="fa fa-file-word-o unccd-color-green" ng-if="refiner.name == \'Word\'"> </span> <span class="fa fa-file-image-o unccd-color-green" ng-if="refiner.name == \'Image\'"> </span> <span class="fa fa-file-powerpoint-o unccd-color-green" ng-if="refiner.name == \'PowerPoint\'"> </span> <span class="fa fa-file-text-o unccd-color-green" ng-if="refiner.name == \'Text\'"> </span> <span class="fa fa-file-excel-o unccd-color-green" ng-if="refiner.name == \'Excel\'"> </span> <span class="fa fa-file-video-o unccd-color-green" ng-if="refiner.name == \'Video\'"> </span> <span class="fa fa-question unccd-color-green" ng-if="refiner.name == \'Unknown\'"> </span> </span> <a href="" title="{{refiner.name| trusted}}" ng-click="facetSelected(title, refiner.name, refiner.from, refiner.to)" ng-bind-html="refiner.name"></a> <small class="unccd-color-gray">({{refiner.count}})</small>&#160;&#160;<span class="glyphicon glyphicon-ok unccd-color-green" ng-show="refiner.enabled"> </span> </li> </ul> </li> </ul> <div class="clearfix"> </div> </div><!--/.facets --> <!-- Info found 0 item  --> <div class="col-md-12 text-center" ng-show="bigTotalItems == -1"> <p class="unccd-clean-md-left unccd-color-gray"> <br><br><br> <small> <strong>Number of search results: {{bigTotalItems}}</strong> </small> <br> </p> </div><!--/.info found 0 item --> <!-- Results --> <div class="col-md-9 unccd-results"> <!-- Navbar --> <nav class="navbar unccd-navbar-count unccd-clear-mg"> <p class="unccd-clean-md-left unccd-color-gray"> <small>Number of search results: <strong>{{bigTotalItems}}</strong></small> </p> </nav><!--/.navbar --> <!-- List items --> <div class="unccd-result-item" ng-repeat="result in results" ng-show="resultsMode == \'list\'"> <h4> <span class="unccd-format-icons" title="{{result.format}}"> <span class="glyphicon glyphicon-globe unccd-color-green" ng-if="result.format == \'HTML\'"> </span> <span class="glyphicon glyphicon-globe unccd-color-green" ng-if="result.format == \'Web Page\'"> </span> <span class="fa fa-file-pdf-o unccd-color-green" ng-if="result.format == \'Adobe PDF\'"> </span> <span class="fa fa-file-word-o unccd-color-green" ng-if="result.format == \'Word\'"> </span> <span class="fa fa-file-image-o unccd-color-green" ng-if="result.format == \'Image\'"> </span> <span class="fa fa-file-powerpoint-o unccd-color-green" ng-if="result.format == \'PowerPoint\'"> </span> <span class="fa fa-file-excel-o unccd-color-green" ng-if="result.format == \'Excel\'"> </span> <span class="fa fa-file-text-o unccd-color-green" ng-if="result.format == \'Text\'"> </span> <span class="fa fa-file-video-o unccd-color-green" ng-if="result.format == \'Video\'"> </span> <span class="fa fa-question unccd-color-green" ng-if="result.format == \'Unknown\'"> </span> </span> <img ng-if="result.partnername === \'AGRIS\'" src="images/logo-agris.12839aae.png" alt="AGRIS" style="height: 20px"> <img ng-if="result.partnername === \'CSIC\'" src="images/logo-csic.c18b0071.png" alt="CSIC" style="height: 20px"> <img ng-if="result.partnername === \'ISRIC\'" src="images/logo-isric.2e575df8.png" alt="ISRIC" style="height: 20px"> <img ng-if="result.partnername === \'TECA\'" src="images/logo-teca.e0aa5cb0.png" alt="TECA" style="height: 20px"> <img ng-if="result.partnername === \'WOCAT\'" src="images/logo-wocat.74b913ee.png" alt="WOCAT" style="height: 20px"> <!--<a href="{{result.url}}{{result.website}}" title="" class="unccd-color-green">--> <a href="#/results?{{queryString}}&docid={{result.id}}" title="" class="unccd-color-green" data-toggle="modal" ng-click="prepareResultModalWithId(result.id, $event)"> <div ng-if="result[\'title_\' + result.language]"> {{result[\'title_\' + result.language]}} </div> <div ng-if="!result[\'title_\' + result.language]"> {{result.title_en}} </div> {{result.kss}}{{result.persontitle}} {{result.firstname}} {{result.lastname}} </a> </h4> <p class="unccd-color-gray">{{result.published| date:\'yyyy-MM-dd\'}}</p> <p class="unccd-color-gray" ng-if="result.abstract_en || result.abstract_es || result.abstract_de || result.abstract_it || result.abstract_fr || result.nationality || result.managingentity"> <!--{{result.abstract_en | limitTo: 200 }} {{longString.length < 200 ? \'\' : \'...\'}}<br />--> {{result.abstract_en}}{{result.abstract_es}}{{result.abstract_de}}{{result.abstract_it}}{{result.abstract_fr}}{{result.nationality}}{{result.managingentity}} </p> <p ng-if="result.disciplines || result.topics"> {{getFormattedVersion(result.disciplines)}}{{getFormattedVersion(result.topics)}} </p> <p> <!--<button class="btn btn-default unccd-color-green" role="button" data-toggle="modal" data-target="#resultItemModal" ng-click="prepareResultModal({{$index}})">View details &raquo;</button>--> <button class="btn btn-default unccd-color-green" role="button" ng-click="prepareResultModalWithId(result.id, $event)">View details &raquo;</button> </p> </div><!--/.listm items --> <!-- Pagination --> <nav class="text-center" ng-show="resultsMode === \'list\' && bigTotalItems > 0"> <pagination total-items="bigTotalItems" ng-model="bigCurrentPage" max-size="maxSize" class="pagination unccd-color-green" boundary-links="true" ng-change="pageChanged()" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo" items-per-page="itemsPerPage"></pagination> </nav><!-- /.pagination --> <!-- Map items --> <div ng-show="resultsMode == \'map\'"> <!-- Map --> <div id="map_canvas" ng-show="resultsMode == \'map\'"></div><br><!-- ./map --> <div id="map_disclaimer" style="margin-bottom: 13px; font-size: 0.8em"> <p> The boundaries and names shown and the designations used on this map do not imply official endorsement or acceptance by the United Nations Convention to Combat Desertification (UNCCD) and the United Nations. <a href="#/disclaimer">Read more></a> </p> </div> </div><!--/.map items --> </div><!--/.results --> <div data-result-item-directive></div> </div><!--/.row --> <!-- Loading ico --> <div ng-show="loading"> <div class="container text-center"> <br><br><br><br> <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> Loading ... <br><br><br><br> </div> </div><!--/.loading ico --> </div><!--/.content -->')}]);